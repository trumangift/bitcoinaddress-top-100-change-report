<!DOCTYPE html>
<html>
    <head>
      <script src="./echarts-all.js"></script>
      <script src="./series.js"></script>
    </head>
    <body>
        <div id="main" style="width: 100%;height: 800px;">
        </div>
    </body>
    <script>

    function readTextFile(file, callback)
    {
        var rawFile = new XMLHttpRequest();
        rawFile.open("GET", file, false);
        rawFile.onreadystatechange = function ()
        {
            if(rawFile.readyState === 4)
            {
                if(rawFile.status === 200 || rawFile.status == 0)
                {
                    var allText = rawFile.responseText;
                    callback(allText);
                }
            }
        }
        rawFile.send(null);
    }
    function getSelected(ss) {
        let result = {};
        ss.addresses.forEach((t, i) => {
            if (i <= 20) {
                result[t] = true;
            } else {
                result[t] = false;
            }
        });
        return result;
    }
    readTextFile('/json', (data) => {
                // 基于准备好的dom，初始化echarts实例
                var myChart = echarts.init(document.getElementById('main'));
                data = JSON.parse(data);
                const xAxis = Object.keys(data);
                const size = 19;
                // 指定图表的配置项和数据
                const ss = series(data, xAxis);
                console.log(ss);
                var option = {
                    title: {
                        text: '比特币财富报表'
                    },
                    tooltip: {
                        trigger: 'item',
                    },
                    legend: {
                        data: ss.addresses,
                        type: 'scroll',
                        orient: 'vertical',
                        right: 10,
                        left: 0,
                        top: 30,
                        selected: getSelected(ss),
                        backgroundColor: 'rgba(0, 245, 255, 0.1)'
                    },
                    xAxis: {
                        type: 'category',
                        data: xAxis,
                    },
                    yAxis: {
                        type: 'value'
                    },
                    series: ss.all_series,
                };
                myChart.setOption(option)
    });
    </script>
</html>
